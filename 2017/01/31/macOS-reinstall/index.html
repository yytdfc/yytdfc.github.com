<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> macOS系统重装工程 · Votec</title><meta name="description" content="macOS系统重装工程 - ChenFu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://votec.top/atom.xml" title="Votec"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/images/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="https://github.com/yytdfc" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">macOS系统重装工程</h1><div class="post-info">Jan 31, 2017<full_date item.date ll>&#8853 <span id="busuanzi_container_page_pv">Viewed<span id="busuanzi_value_page_pv"></span> times</span></full_date></div><div class="post-content"><h2 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h2><p>前两天一个逗比的想法突然砸中我的脑袋，我用Mac也一年了，但是之前用的好像不是那么完美，于是强迫症又犯了，于是我做了一个作大死的决定：<strong>重装系统！</strong>。</p>
<a id="more"></a>
<blockquote>
<p>每一个问题都有原因，也都有答案。</p>
</blockquote>
<p>于是乎我开始了重装系统，首先很快Google到了Apple官方的<a href="https://support.apple.com/zh-cn/HT204904" target="_blank" rel="external">重装macOS方法</a><strong>(友情提示：慎重采用！慎重采用！慎重采用！)</strong>：</p>
<blockquote>
<ol>
<li><p>将 Mac 开机或重新启动后，立即按住 Option-Command (⌘)-R 以从互联网恢复功能启动。看到 Apple 标志时松开这两个键。看到“实用工具”窗口时，启动即完成。</p>
</li>
<li><p>从“实用工具”窗口中打开“磁盘工具”，然后使用“磁盘工具”抹掉您的内建硬盘（使用“Mac OS 扩展（日志式）”格式）。完成后，退出“磁盘工具”。</p>
</li>
<li><p>在“实用工具”窗口中，选取“重新安装 macOS”（或“重新安装 OS X”）， 然后按照屏幕上的说明进行操作。<br>此操作将安装您的 Mac 最初随附的系统。它未与您的 Apple ID 关联，因此，新所有者可以使用其 Apple ID 通过 App Store 升级到更高版本。</p>
</li>
<li><p>完成后，您的 Mac 会重新启动并进入设置助理。按下“Command-Q”，然后点按“关机”。新所有者便可以使用自己的信息完成设置助理的各个步骤。</p>
</li>
</ol>
</blockquote>
<p>看起来一切都是那么的人性化和美好，于是我简单备份了home文件夹后，愉快的开始了作大死之旅。</p>
<h2 id="macOS到底该如何重新安装"><a href="#macOS到底该如何重新安装" class="headerlink" title="macOS到底该如何重新安装"></a>macOS到底该如何重新安装</h2><p>按照上述做法，从互联网重新安装系统，这里有两大bug，一是安装的是<em>Mac最初随附的系统</em>，安装好以后还要更新；第二也是最致命的，从互联网安装新系统压根下载不下来啊，看着这感人的进度条，明明过了一天一夜，也不过进行约五分之一不到，剩余时间11个小时也从来没有变过。</p>
<p>那么，随之而来的一个问题：<strong>我们到底该如何重装macOS呢？</strong> 经过我的一番研究倒腾之后，最优方案如下（以macOS Sierra 10.12为例）：</p>
<ol>
<li><p>首先获取一个系统的安装文件，如果macOS 10.9以上的版本，一般是获得一个Application的格式，具体获得方法参考<a href="https://support.apple.com/zh-cn/HT201475" target="_blank" rel="external">官方文档</a>。但是如果你现在手头没有Mac或者担心下载速度太慢，那么还是百度找一个下载链接吧。</p>
</li>
<li><p>挂载应用<code>macOS Sierra 10.12.dmg</code>文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hdiutil attach macOS\ Sierra\ 10.12.dmg</div></pre></td></tr></table></figure>
</li>
<li><p>。。。</p>
</li>
</ol>
<h3 id="系统设置"><a href="#系统设置" class="headerlink" title="系统设置"></a>系统设置</h3><p>设置显示隐藏文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">defaults write com.apple.finder AppleShowAllFiles -boolean <span class="literal">true</span> ; killall Finder</div></pre></td></tr></table></figure></p>
<p>dock隐藏显示时间：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">defaults write com.apple.Dock autohide-delay -<span class="built_in">float</span> 0 &amp;&amp; killall dock</div></pre></td></tr></table></figure></p>
<h3 id="Brew包管理"><a href="#Brew包管理" class="headerlink" title="Brew包管理"></a>Brew包管理</h3><p>安装<a href="http://brew.sh" target="_blank" rel="external">Brew</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></div></pre></td></tr></table></figure></p>
<p>中途会提示安装XCode Command Tools，安装。</p>
<h3 id="安装zsh"><a href="#安装zsh" class="headerlink" title="安装zsh"></a>安装zsh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装zsh</span></div><div class="line">brew install zsh</div><div class="line"><span class="comment"># 安装Oh—my-zsh</span></div><div class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></div></pre></td></tr></table></figure>
<p>然后会看到这个就说明装好了：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">         __                                     __</div><div class="line">  ____  / /_     ____ ___  __  __   ____  _____/ /_</div><div class="line"> / __ \/ __ \   / __ `__ \/ / / /  /_  / / ___/ __ \</div><div class="line">/ /_/ / / / /  / / / / / / /_/ /    / /_(__  ) / / /</div><div class="line">\____/_/ /_/  /_/ /_/ /_/\__, /    /___/____/_/ /_/</div><div class="line">                        /____/                       ....is now installed!</div></pre></td></tr></table></figure></p>
<p>然后对robbyrussell主题做简单更改，编辑<code>.oh-my-zsh/themes/robbyrussell.zsh-theme</code>:</p>
<p>改为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PROMPT=<span class="string">'$&#123;ret_status&#125;%&#123;$fg_bold[green]%&#125;%p %&#123;$fg[cyan]%&#125;%c %&#123;$fg_bold[blue]%&#125;$(git_prompt_info)%&#123;$fg_bold[blue]%&#125; %&#123;$fg_bold[white]%&#125;&gt; %&#123;$reset_color%&#125;'</span></div></pre></td></tr></table></figure></p>
<h3 id="安装vim"><a href="#安装vim" class="headerlink" title="安装vim"></a>安装vim</h3><h4 id="安装MacVim"><a href="#安装MacVim" class="headerlink" title="安装MacVim"></a>安装MacVim</h4><p>打开<code>MacVim.dmg</code>，拖动MacVim到Application，<code>cp mvim /usr/local/bin/</code></p>
<h4 id="配置vim文件"><a href="#配置vim文件" class="headerlink" title="配置vim文件"></a>配置vim文件</h4><p>安装k-vim配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/wklken/k-vim.git</div><div class="line">./install.sh</div></pre></td></tr></table></figure></p>
<h3 id="安装Atom"><a href="#安装Atom" class="headerlink" title="安装Atom"></a>安装Atom</h3><p>Atom的<a href="https://github.com/atom/atom/releases/tag/v1.13.1" target="_blank" rel="external">官方release地址</a></p>
<h3 id="安装Python"><a href="#安装Python" class="headerlink" title="安装Python"></a>安装Python</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">brew install python3</div><div class="line">pip3 install jupyter numpy matplotlib scipy pandas  cython</div></pre></td></tr></table></figure>
<h4 id="安装quandl"><a href="#安装quandl" class="headerlink" title="安装quandl"></a>安装quandl</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip3 install quandl statsmodels</div></pre></td></tr></table></figure>
<h4 id="安装spyder"><a href="#安装spyder" class="headerlink" title="安装spyder"></a>安装spyder</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip3 install spyder PyQt5</div></pre></td></tr></table></figure>
<h4 id="安装二维码相关"><a href="#安装二维码相关" class="headerlink" title="安装二维码相关"></a>安装二维码相关</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">brew install zbar</div><div class="line">pip3 install qrcode zbarlight</div></pre></td></tr></table></figure>
<h4 id="安装机器学习相关"><a href="#安装机器学习相关" class="headerlink" title="安装机器学习相关"></a>安装机器学习相关</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip3 install scikit-learn</div></pre></td></tr></table></figure>
<h4 id="安装TensorFlow"><a href="#安装TensorFlow" class="headerlink" title="安装TensorFlow"></a>安装TensorFlow</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip3 install tensorflow</div></pre></td></tr></table></figure>
<h4 id="安装-Lua-Torch-iTorch"><a href="#安装-Lua-Torch-iTorch" class="headerlink" title="安装 Lua Torch iTorch"></a>安装 <a href="http://www.lua.org/download.html" target="_blank" rel="external">Lua</a> <a href="http://torch.ch/docs/getting-started.html" target="_blank" rel="external">Torch</a> <a href="https://github.com/facebook/iTorch" target="_blank" rel="external">iTorch</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># install Torch</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/torch/distro.git torch --recursive</div><div class="line"><span class="built_in">cd</span> torch; bash install-deps;</div><div class="line">./install.sh</div><div class="line"><span class="comment"># install iTorch</span></div><div class="line">brew install zeromq</div><div class="line">brew install openssl</div><div class="line">luarocks install luacrypto OPENSSL_DIR=/usr/<span class="built_in">local</span>/opt/openssl/</div><div class="line">git <span class="built_in">clone</span> https://github.com/facebook/iTorch.git</div><div class="line"><span class="built_in">cd</span> iTorch</div><div class="line">luarocks make</div><div class="line"><span class="comment"># PyTorch</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/pytorch/pytorch.git</div><div class="line"><span class="built_in">cd</span> pytorch</div><div class="line">pip3 install numpy setuptools cmake cffi</div><div class="line">pip3 install -r requirements.txt</div><div class="line">pip3 install tools</div><div class="line">python3 setup.py install</div></pre></td></tr></table></figure>
<h4 id="安装Caffe"><a href="#安装Caffe" class="headerlink" title="安装Caffe"></a>安装Caffe</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">brew install -vd snappy leveldb gflags glog szip lmdb</div><div class="line"><span class="comment"># need the homebrew science source for OpenCV and hdf5</span></div><div class="line">brew tap homebrew/science</div><div class="line">brew install hdf5 opencv</div><div class="line"><span class="comment"># with Python pycaffe needs dependencies built from source</span></div><div class="line">brew install --build-from-source --with-python -vd protobuf</div><div class="line">brew install --build-from-source -vd boost boost-python</div><div class="line">brew install boost snappy leveldb protobuf gflags glog szip lmdb homebrew/science/opencv</div></pre></td></tr></table></figure>
<p>遇到如下错误<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">./include/caffe/util/mkl_alternate.hpp:14:10: fatal error: <span class="string">'cblas.h'</span> file not found</div><div class="line"><span class="comment">#include &lt;cblas.h&gt;</span></div><div class="line">         ^</div><div class="line">1 error generated.</div><div class="line">make: *** [.build_release/src/caffe/data_transformer.o] Error 1</div></pre></td></tr></table></figure></p>
<p><code>mdfind cblas.h</code>找到路径，然后编辑<code>Makefile.config</code>加入路径到这行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BLAS_INCLUDE := /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/Headers</div></pre></td></tr></table></figure></p>
<h3 id="安装mac预览增强工具quick-look-plugins"><a href="#安装mac预览增强工具quick-look-plugins" class="headerlink" title="安装mac预览增强工具quick-look-plugins"></a>安装mac预览增强工具<a href="https://github.com/sindresorhus/quick-look-plugins" target="_blank" rel="external">quick-look-plugins</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew cask install qlcolorcode</div></pre></td></tr></table></figure>
<h3 id="安装Tickeys"><a href="#安装Tickeys" class="headerlink" title="安装Tickeys"></a>安装<a href="http://www.yingdev.com/projects/tickeys" target="_blank" rel="external">Tickeys</a></h3><p><strong>To be continued</strong></p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/05/24/alphago-mcts/" class="prev">Prev</a><a href="/2017/01/01/python-swig/" class="next">Next</a></div><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script><script>var cloudTieConfig = {url: document.location.href,sourceId: "2017/01/31/macOS-reinstall/",productKey: "b710aea8146b4b82be4291d960552145",target: "cloud-tie-wrapper"};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);</script><div class="copyright"><p>© 2016~2017 <a href="http://votec.top">ChenFu</a>  &#8225  Site viewed <span id="busuanzi_value_site_pv"></span> times.</span></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> + <a href="https://github.com/yytdfc/hexo-theme-apollo-plus" target="_blank">apollo</a> <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv"></p></div></footer></div><script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" type="text/javascript"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-100648993-1','auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "https://hm.baidu.com/hm.js?3a1457089b82f026e9a39fbe773531ff";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();</script><script type="text/javascript" src="http://tajs.qq.com/stats?sId=59104549" charset="UTF-8"></script></body></html>